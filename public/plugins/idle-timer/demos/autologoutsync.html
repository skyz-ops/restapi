<!doctype html><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Jquery-idletimer : provides you a way to monitor user activity with a page."><title>Jquery-idletimer</title><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script src=../src/idle-timer.js></script><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css integrity=sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js integrity=sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1 crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js integrity=sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM crossorigin=anonymous></script><script src=https://momentjs.com/downloads/moment.min.js></script><style>body{padding-top:5rem}</style><nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top"><a class=navbar-brand href=index.html>Jquery-idletimer</a> <button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarsExampleDefault aria-controls=navbarsExampleDefault aria-expanded=false aria-label="Toggle navigation"><span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarsExampleDefault><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=index.html>Main Demo</a><li class=nav-item><a class=nav-link href=autologout.html>Auto Logout</a><li class=nav-item><a class=nav-link href=defaultbinding.html>Default Binding</a><li class=nav-item><a class=nav-link href=https://github.com/thorst/jquery-idletimer>Documentation</a></ul><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://github.com/thorst/jquery-idletimer/zipball/master>Zip</a><li class=nav-item><a class=nav-link href=https://github.com/thorst/jquery-idletimer/tarball/master>Tar</a><li class=nav-item><a class=nav-link href=https://github.com/thorst/jquery-idletimer>Github</a></ul></div></nav><div class=container><h2>Concept</h2><p>Wait 10 seconds, you will see a expiring warning. Wait 10 more seconds and you will see that you have been logged out.<p>In the real world I forward them to the logout url, which intern fowards them to login screen, instead of showing the 2nd dialog. You can modify the app.session.logout function.<p>We could use the active.idleTimer event to clearTimeout, however I prefer the user to explicitly say they want to keep the session open by clicking ok, not just moving the mouse on the screen.<p>This demo takes into account when a mobile device closes the browser, and after the idle timeout expires, launches the browser again. Instead of displaying the warning, it will jump straight to the logged out dialog.<p>For this demo we've enabled localStorage to sync accross tabs of the same browser. This will keep the client side happy, but we still need a keepAlive service to keep the server side session active.<p>For the sake of complete demo, I've included the code needed to call a keepalive url to keep the server side session valid.</div><div class="modal fade" id=mdlExpirationWarning tabindex=-1 role=dialog aria-labelledby=exampleModalLabel aria-hidden=true data-backdrop=static data-keyboard=false><div class=modal-dialog role=document><div class=modal-content><div class=modal-header><h5 class=modal-title id=exampleModalLabel>Session Expiration Warning</h5></div><div class=modal-body><p>You've been inactive for a while. For your security, we'll log you out automatically. Click "Stay Online" to continue your session.<p>Your session will expire in <span class=bold id=sessionSecondsRemaining>120</span> seconds.</div><div class=modal-footer><button id=extendSession type=button class="btn btn-primary" data-dismiss=modal>Stay Online</button> <button id=logoutSession type=button class="btn btn-secondary">Logout</button></div></div></div></div><div class="modal fade" id=mdlLoggedOut tabindex=-1 role=dialog aria-labelledby=exampleModalLabel aria-hidden=true data-backdrop=static data-keyboard=false><div class=modal-dialog role=document><div class=modal-content><div class=modal-header><h5 class=modal-title id=exampleModalLabel>You have been logged out</h5></div><div class=modal-body><p>Your session has expired.</div></div></div></div><script>window.app=window.app||{},app.session={warningTimeout:1e4,inactiveTimeout:2e4,minWarning:5e3,timerSyncId:"SomethingUnique",logoutUrl:"/logout",keepAliveUrl:"api/user/KeepAlive",keepaliveInterval:5e3,warningStart:null,warningTimer:null,keepaliveTimer:null,logout:function(){"undefined"!=typeof localStorage&&localStorage.setItem(app.session.timerSyncId,0),$("#mdlExpirationWarning").modal("hide"),$("#mdlLoggedOut").modal("show")},keepAlive:function(){$("#mdlExpirationWarning").modal("hide"),clearTimeout(app.session.warningTimer),app.session.warningTimer=null,$(document).idleTimer("reset")},startKeepAliveTimer:function(){clearTimeout(app.session.keepaliveTimer),app.session.keepaliveTimer=setInterval((function(){app.session.sendKeepAlive()}),app.session.inactiveTimeout/2)},sendKeepAlive:function(){"undefined"!=typeof localStorage&&localStorage.setItem(app.session.timerSyncId+"_keepalive",+new Date)},showWarning:function(e){var i=+new Date-e.lastActive-e.timeout,n=+new Date-i;$(document).idleTimer("pause"),i>=app.session.warningTimeout||n<=app.session.minWarning?app.session.logout():($("#sessionSecondsRemaining").html(Math.round((app.session.warningTimeout-i)/1e3)),$("#mdlExpirationWarning").modal("show"),app.session.warningStart=+new Date-i,app.session.warningTimer=setInterval((function(){var e=Math.round(app.session.warningTimeout/1e3-(+new Date-app.session.warningStart)/1e3);e>=0?$("#sessionSecondsRemaining").html(e):app.session.logout()}),1e3))},localWrite:function(e){"undefined"!=typeof localStorage&&e.originalEvent.key==app.session.timerSyncId&&null!=app.session.warningTimer?0==e.originalEvent.newValue?app.session.logout():app.session.keepAlive():"undefined"!=typeof localStorage&&e.originalEvent.key==app.session.timerSyncId+"_keepalive"&&app.session.startKeepAliveTimer()}},$((function(){$(document).on("idle.idleTimer",(function(e,i,n){app.session.showWarning(n)})),app.session.startKeepAliveTimer(),$("#extendSession").click((function(){app.session.keepAlive()})),$("#logoutSession").click((function(){app.session.logout()})),$(document).idleTimer({timeout:app.session.inactiveTimeout-app.session.warningTimeout,timerSyncId:app.session.timerSyncId}),$(window).bind("storage",app.session.localWrite)}))</script>